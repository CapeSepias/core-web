<!DOCTYPE html>
<html>
    <header>
        <script src="https://ajax.googleapis.com/ajax/libs/dojo/1.13.0/dojo/dojo.js"></script>

    </header>
    <body>
        <h2>Main Page</h2>
        <template id="jqueryTemplate">
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <style>
                h2 {
                    color: red;
                }
            </style>
            <h2>Jquery Template</h2>
            <button onClick="fireEvent()" >Fire Event !</button>
            <script>
                function fireEvent(){
                    var event = new CustomEvent('valueChange', {value: 'test'});
                    // document.dispatchEvent(event);
                    window.dispatchEvent(event);
                }

                window.addEventListener("valueChange", inner);

                var beto = 'happy';

                function inner(event){
                    debugger;
                    console.log(event.detail);
                }

            </script>
        </template>

        <select id="city" name="city" onchange="emitEvent(this)">
            <option>San Jose</option>
            <option>Alajuela</option>
            <option>Heredia</option>
        </select>

        <div id="host"></div>

        <div id="hostJquery"></div>
        <button onClick="attach()">INCLUDE JQUERY</button>

        <button onClick="clearq()" >Clear!</button>


<script>

    const host = document.querySelector('#host');
    const template = document.querySelector('#jqueryTemplate');
    const root = host.attachShadow({mode: 'closed'});

    function attach() {
        root.appendChild(template.content);
        window.addEventListener("valueChange", proceess);
    }

    function clearq() {
        debugger;
        const div = document.createElement("div");
        root.innerHTML = '<div></div>';
    }

    function proceess(event){
        debugger;
        console.log(event.detail);
    }

</script>


        <select id="city" name="city" onchange="emitEvent(this)">
            <option>San Jose</option>
            <option>Alajuela</option>
            <option>Heredia</option>
        </select>


        <script>
            function emitEvent(select) {
                var event = new CustomEvent('valueChange', { 'detail': { 'fieldType': 'city', 'value': select.value}});
                document.dispatchEvent(event);
            }

            document.addEventListener("valueChange", proceess);

            function proceess(event){
                console.log(event.detail);
            }

        </script>

</body>
</html>


