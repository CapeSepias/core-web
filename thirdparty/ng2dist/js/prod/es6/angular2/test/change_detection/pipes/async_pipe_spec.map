{"version":3,"sources":["async_pipe_spec.js"],"names":[],"mappings":"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","file":"angular2/test/change_detection/pipes/async_pipe_spec.es6","sourcesContent":["import {ddescribe, describe, it, iit, xit, expect, beforeEach, afterEach,\n  AsyncTestCompleter, inject, proxy, SpyObject} from 'angular2/test_lib';\nimport {IMPLEMENTS} from 'angular2/src/facade/lang';\n\nimport {WrappedValue} from 'angular2/src/change_detection/pipes/pipe';\nimport {AsyncPipe} from 'angular2/src/change_detection/pipes/async_pipe';\nimport {ChangeDetectorRef} from 'angular2/src/change_detection/change_detector_ref';\nimport {EventEmitter, Observable, ObservableWrapper, PromiseWrapper} from 'angular2/src/facade/async';\n\nexport function main() {\n  describe(\"AsyncPipe\", () => {\n    var emitter;\n    var pipe;\n    var ref;\n    var message = new Object();\n\n    beforeEach(() => {\n      emitter = new EventEmitter();\n      ref = new SpyChangeDetectorRef();\n      pipe = new AsyncPipe(ref);\n    });\n\n    describe(\"supports\", () => {\n      it(\"should support observables\", () => {\n        expect(pipe.supports(emitter)).toBe(true);\n      });\n\n      it(\"should not support other objects\", () => {\n        expect(pipe.supports(\"string\")).toBe(false);\n        expect(pipe.supports(null)).toBe(false);\n      });\n    });\n\n    describe(\"transform\", () => {\n      it(\"should return null when subscribing to an observable\", () => {\n        expect(pipe.transform(emitter)).toBe(null);\n      });\n\n      it(\"should return the latest available value wrapped\", inject([AsyncTestCompleter], (async) => {\n        pipe.transform(emitter);\n\n        ObservableWrapper.callNext(emitter, message);\n\n        PromiseWrapper.setTimeout(() => {\n          expect(pipe.transform(emitter)).toEqual(new WrappedValue(message));\n          async.done();\n        }, 0)\n      }));\n\n      it(\"should return same value when nothing has changed since the last call\",\n          inject([AsyncTestCompleter], (async) => {\n        pipe.transform(emitter);\n        ObservableWrapper.callNext(emitter, message);\n\n        PromiseWrapper.setTimeout(() => {\n          pipe.transform(emitter);\n          expect(pipe.transform(emitter)).toBe(message);\n          async.done();\n        }, 0)\n      }));\n\n      it(\"should dispose of the existing subscription when subscribing to a new observable\",\n          inject([AsyncTestCompleter], (async) => {\n        pipe.transform(emitter);\n\n        var newEmitter = new EventEmitter();\n        expect(pipe.transform(newEmitter)).toBe(null);\n\n        // this should not affect the pipe\n        ObservableWrapper.callNext(emitter, message);\n\n        PromiseWrapper.setTimeout(() => {\n          expect(pipe.transform(newEmitter)).toBe(null);\n          async.done();\n        }, 0)\n      }));\n\n      it(\"should request a change detection check upon receiving a new value\",\n          inject([AsyncTestCompleter], (async) => {\n        pipe.transform(emitter);\n        ObservableWrapper.callNext(emitter, message);\n\n        PromiseWrapper.setTimeout(() => {\n          expect(ref.spy('requestCheck')).toHaveBeenCalled();\n          async.done();\n        }, 0)\n      }));\n    });\n\n    describe(\"onDestroy\", () => {\n      it(\"should do nothing when no subscription\", () => {\n        pipe.onDestroy();\n      });\n\n      it(\"should dispose of the existing subscription\", inject([AsyncTestCompleter], (async) => {\n        pipe.transform(emitter);\n        pipe.onDestroy();\n\n        ObservableWrapper.callNext(emitter, message);\n\n        PromiseWrapper.setTimeout(() => {\n          expect(pipe.transform(emitter)).toBe(null);\n          async.done();\n        }, 0)\n      }));\n    });\n  });\n}\n\n@proxy\n@IMPLEMENTS(ChangeDetectorRef)\nclass SpyChangeDetectorRef extends SpyObject {\n  constructor(){super(ChangeDetectorRef);}\n  noSuchMethod(m){return super.noSuchMethod(m)}\n}\n"]}